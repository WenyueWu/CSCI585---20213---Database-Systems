--  	create table

CREATE EXTENSION postgis;

CREATE TABLE geometries (name varchar, geom geometry);

INSERT INTO geometries VALUES
  ('Health center', 'POINT(-118.2887101850045 34.02497891520108)'),
  ('Lyon center', 'POINT(-118.288444426288 34.02472392984444)'),
  ('Cromwell Field', 'POINT(-118.28706489486818 34.022185653740564)'),
  ('Viterbi', 'POINT(-118.28875441829328 34.02091164706839)'),
  ('USC Bookstores', 'POINT(-118.28646378483482 34.02091308895304)'),
  ('Trojan Statue', 'POINT(-118.285414414432 34.0204903815472)'),
  ('Traveler Statue', 'POINT(-118.28521736859099 34.020161798135746)'),
  ('Library for IPA', 'POINT(-118.2841689047574 34.02167177296618)'),
  ('Leavey Library', 'POINT(-118.2829088532536 34.02144445575226)'),
  ('DM Library', 'POINT(-118.28409732330431 34.02030099652159)'),
  ('Bing Theatre', 'POINT(-118.28565744285763 34.022281575178255)'),
  ('Hecuba Statue', 'POINT(-118.2847643551587 34.02500228028197)'),
  ('Home', 'POINT(-118.30013371302617 34.02713792283306)');
  
--		a. convex hull
SELECT ST_AsText(ST_ConvexHull( 
    ST_Collect( 
 
            ST_GeomFromText('MultiPOINT(
							-118.2887101850045 34.02497891520108,
							-118.288444426288 34.02472392984444,
							-118.28706489486818 34.022185653740564,
							-118.28875441829328 34.02091164706839,
							-118.28646378483482 34.02091308895304,
							-118.285414414432 34.0204903815472,
							-118.28521736859099 34.020161798135746,
							-118.2841689047574 34.02167177296618,
							-118.2829088532536 34.02144445575226,
							-118.28409732330431 34.02030099652159,
							-118.28565744285763 34.022281575178255,
							-118.2847643551587 34.02500228028197,
							-118.30013371302617 34.02713792283306)' )
            ) ));
							

--		b. nearest-neighbor line
select name,ST_AsText(geom) 
from geometries 
where ST_GeometryType(geom) = 'ST_Point' 
and name not in('Home')
order by geom <-> ST_PointFromText('POINT(-118.30013371302617 34.02713792283306)')
limit 4
